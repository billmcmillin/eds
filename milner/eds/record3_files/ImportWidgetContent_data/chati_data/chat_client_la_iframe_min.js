/** Copyright 2007-2013 Springshare LLC. All Rights Reserved. Springshare is a registered trademark. */
function CascadeMessageT(e,a){this.room=e,this.op2op="",this.message=a}function widgetT(){}function loadTemplates(e,a){var t=encodeURIComponent(JSON.stringify({iid:global.iid,key:global.key,files:e})),l=$.ajax({url:"_template_loader.php",type:"post",data:"cmd=get_file&parms="+t});l.done(function(e){try{if(null!=a){var t=JSON.parse(e),l="undefined"==typeof a.arg?null:a.arg;a.success(t,l)}}catch(o){return void alert("Fatal error:"+o.message)}}),l.fail(function(e){null!=a&&"undefined"!=typeof a.failure&&a.failure(e)}),l.always(function(){null!=a&&"undefined"!=typeof a.always&&a.always()})}function _init(){function e(){return alert("Sorry the upload failed. Please try again."),$("#lc_fu").val("Upload!").prop("disabled",!1).css("width","70px").css("font-size","15px"),$("#hiddenarea").remove(),!1}_.templateSettings={evaluate:/\{\{#([\s\S]+?)\}\}/g,interpolate:/\{\{[^#\{]([\s\S]+?)[^\}]\}\}/g,escape:/\{\{\{([\s\S]+?)\}\}\}/g},global.templates={},global.templates.login_panel=$("#template-login-panel").html(),global.templates.chat_panel=$("#template-chat-panel").html(),global.templates.star_panel=$("#template-star-panel").html(),global.templates.end_panel=$("#template-end-panel").html(),global.templates.file_upload_panel=$("#template-file-upload-panel").html(),global.cobrowse_target=window,COBROWSE&&window.addEventListener("message",function(e){try{var a=JSON.parse(e.data);if("co_browse_ready"===a.cmd)try{var t={};t.channel=global.q_channel,t.sessionID=cascade.subscribedData.id;var l=global.q_channel+"-"+cascade.subscribedData.id;cascade.emit("send_to_room",{room:l,event:"co_browse_ready",obj:t})}catch(e){}}catch(o){}},!1),global.mdl=global.isHash?new widgetModelT(global.widgetInfo):new widgetModelT;var a=global.mdl.get("custom_css");if(""!==a&&$("head").append("<style>"+a+"</style>"),renderLogin(),$("#lc_cb").on("click",function(){doLogin()}),$("#name").keypress(function(e){var a=e.charCode||e.keyCode;13==a&&doLogin()}),$("#sound").jPlayer({ready:function(){$(this).jPlayer("setMedia",{mp3:"//libchat.s3.amazonaws.com/chat_beep.mp3"})},solution:"html,flash",supplied:"mp3",swfPath:"//libchat.s3.amazonaws.com/",volume:1}),$(".s_icon").on("click",function(e){e.preventDefault(),global.enable_sound===!0?(global.enable_sound=!1,$(".s_icon").removeClass("son").addClass("soff").prop("title",global.sound_off)):(global.enable_sound=!0,$(".s_icon").removeClass("soff").addClass("son").prop("title",global.sound_on))}),$("#star_rating").on("click",function(){var e=$("input[name=chat_rating]:radio:checked").val(),a=cascade.subscribedData.channel+"-"+cascade.subscribedData.id;$.ajax({url:"/chat_trigger.php?t=rate",type:"POST",dataType:"json",data:{channel:a,rate:e},success:function(){$("#star_text").text(""),$("#star_rating").html("<p>Thanks for rating!</p>")}})}),$("#chat_txt").keyup(function(){var e=$.trim($("#chat_txt").val());clearTimeout(global.typing_end_timeout),""==e&&global.is_typing_currently?global.typing_end_timeout=setTimeout(timout_function,2e3):global.is_typing_currently||(global.is_typing_currently=!0,typing_status("1"))}),$("#chat_txt").keydown(function(e){if(13==e.keyCode&&0==e.shiftKey){var a=$.trim($("#chat_txt").val());if(""!=a){$("#chat_txt").val("").focus(),a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;").replace(/(https?:[^\s]+)/,'<a href="$1" target="_blank">$1</a>');var t=new CascadeMessageT(cascade.subscribedData.id,a);cascade.emit("new_message",t);var l=new Date;dspChatMsg('<div class="lci_msg"><span class="lci_un lci_me">you:</span> '+a+'<br /><span aria-hidden="true" class="lci_published" pubtime="'+l+'" title="'+l+'">'+timeToDescription(l)+"</span></div>")}return!1}}),$(".t_icon").on("click",function(e){e.preventDefault();var a=prompt(global.trans_prompt,"");if(!a||""===a)return!1;var t=$("#msgs").html();$.ajax({url:"/chat_transcript.php",type:"POST",dataType:"json",data:{msg:t,email:a,iid:global.iid},success:function(e){dspChatMsgStatus(e.status)},error:function(){dspChatMsgStatus(global.error_tran)}})}),$(".f_icon").on("click",function(e){return e.preventDefault(),$("#chat").fadeOut("fast",function(){$("#file").fadeIn("fast")}),!1}),$("#lc_fcan").on("click",function(e){return e.preventDefault(),$("#file").fadeOut("fast",function(){$("#chat").fadeIn("fast"),$("#lc_fu").val("Upload!").prop("disabled",!1).css("width","70px").css("font-size","15px"),$("#msg_con").animate({scrollTop:$("#msg_con").prop("scrollHeight")},1e3)}),!1}),$("#lc_fu").on("click",function(a){a.preventDefault();var t=$("#ufile").val();return""==t?(alert("You must attach a file!"),!1):($("#lc_fu").val("Uploading.. Please wait!").prop("disabled",!0).css("width","150px").css("font-size","12px"),$("body").append('<div id="hiddenarea"></div>'),$("#fileup").ajaxSubmit({target:"#hiddenarea",url:"/chat_fileup.php?m=fuprocess&i="+global.iid,success:function(a){var t=a.split("#@#@");if(parseInt(t[0])>0){var l="attached a file: http://"+global.ladom+"/chat_file.php?i="+global.iid+"&f="+t[1];l=l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;").replace(/(http:[^\s]+)/,'<a href="$1" target="_blank">$1</a>');var o=new CascadeMessageT(cascade.subscribedData.id,l);cascade.emit("new_message",o);var s=new Date;dspChatMsg('<div class="lci_msg">'+l+'<br /><span aria-hidden="true" class="lci_published" pubtime="'+s+'" title="'+s+'">'+timeToDescription(s)+"</span></div>"),$("#file").fadeOut("fast",function(){$("#chat").fadeIn("fast"),$("#msg_con").animate({scrollTop:$("#msg_con").prop("scrollHeight")},1e3),$("#lc_fu").val("Upload!").prop("disabled",!1).css("width","70px").css("font-size","15px"),$("#ufile").val("")})}else e();return $("#hiddenarea").remove(),!1},error:function(){e()}}),!1)}),$("#peel_out").on("click",function(e){e.preventDefault(),peelOut(global.cobrowse_target)}),$("#peel_out").hide(),$(".e_icon").on("click",function(e){e.preventDefault();try{global.reconnect=!1,cascade.socket.connected?cascade.disconnect():resetDisplay()}catch(e){resetDisplay()}}),$("#cl, #cls").on("click",function(e){e.preventDefault(),""===global.peel?initDisplayState():window.close()}),$(window).bind("unload",function(){try{global.reconnect=!1,cascade.disconnect()}catch(e){}return!0}),-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&-1==navigator.userAgent.indexOf("Android")&&0==global.saf&&(2==global.wtype||3==global.wtype||5==global.wtype)){var t=window.location+"&saf=1";$("body").append('<div id="overlay" style="position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: #FFF;opacity: 0.0;z-index: 10000;"> </div>'),$("#overlay").on("click",function(e){e.preventDefault(),window.open(t,"libchat","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=yes, copyhistory=no, width=300, height=400"),$("body").html('<p style="padding: 10px;">Chat will launch in a <a href="#" onclick="window.open(\''+t+"','libchat','toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=yes, copyhistory=no, width=300, height=400');return false;\">new window</a>.</p>")})}navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)&&$("head").append('<meta name="viewport" content="width=device-width, maximum-scale=1.0" />'),navigator.userAgent.toLowerCase().indexOf("android")>-1&&$("head").append('<meta name="viewport" content="width=device-width" />'),""!==global.peel&&doLogin()}function dspChatMsgStatus(e){$("#msgs_status").html(e)}function dspChatMsg(e){$("#msgs").append(e),$("#msg_con").animate({scrollTop:$("#msg_con").prop("scrollHeight")},1e3)}function initDisplayState(){global.wtype==widgetT.prototype.SYSTEM_BUTTON||global.wtype==widgetT.prototype.DIRECT_BUTTON?window.close():window.location.reload()}function resetDisplay(){$("#chat_txt").prop("disabled",!0),$("#file").hide(),global.star_ratings?$("#chat").fadeOut("fast",function(){$("#star").fadeIn("fast")}):$("#chat").fadeOut("fast",function(){$("#end").fadeIn("fast")})}function renderLogin(){""===global.byeMsg&&(global.byeMsg=global.chat_title);var e;global.isHash?e=global.mdl.toJSON():(e={},e.enable_comments=""!==global.comments,e.comments_label=global.comments,e.comments_button_text=global.comments_button_text,e.chat_title=global.chat_title,e.byeMsg=global.byeMsg,e.ops_left=global.ops_left,e.star_text=global.star_text,e.color_head=global.color_head,e.color_backg=global.color_back,e.color_border=global.color_bord,e.color_btn=global.color_btn,e.chat_button=global.chat_button,e.done_button=global.done_button,e.sound_off=global.sound_off,e.initial_question=""!==global.initialq,e.initial_question_label=global.initialq,e.name_label=global.name_label,e.dept_label=global.depart_label,e.depart_id=global.depart_id,e.depart_default_id=global.depart_id,e.depart_dedicated="0"!==e.depart_id,e.star_ratings=global.star_ratings,e.enable_anon=!0,e.file_uploads=global.file_uploads,e.press_enter="Press ENTER to send",e.user1=null,e.user2=null,e.user3=null,e.user4=null,e.user5=null,e.widget_type=global.wtype,e.is_personal=global.wtype<4?!1:!0),$("#loading").hide(),global.wtype<4&&0==global.depart_id&&(global.depart_html='<div class="login_field"><span id="chat_depts">'+global.depart_html+"</span></div>"),e.department_selector=global.depart_html;try{$("#login").html(_.template(global.templates.login_panel,e))}catch(a){$("#login").html("Error rendering template: "+a.message)}var t=parseInt(e.depart_default_id),l=$("select#lc_dept_sel option[value='"+t+"']");l.attr("selected","selected"),$("input, textarea").placeholder(),$("#chat").hide();try{$("#chat").html(_.template(global.templates.chat_panel,e))}catch(a){$("#chat").html("Error rendering template: "+a.message)}$("#file").hide(),$("#file").html(_.template(global.templates.file_upload_panel,e)),$("#star").hide(),$("#star").html(_.template(global.templates.star_panel,e)),$("#end").hide(),$("#end").html(_.template(global.templates.end_panel,e)),""!==global.name_default&&$("#name").text(global.name_default),global.isHash&&($("#libchat_btn_widget").css("float","left"),$("#libchat_btn_widget").css("width",e.slidebutton_width+"px"),$("#libchat_btn_widget").css("height",e.slidebutton_height+"px"),$("#libchat_btn_widget").css("background-color","transparent")),global.enable_sound===!0?$(".s_icon").removeClass("soff").addClass("son").prop("title",global.sound_on):$(".s_icon").removeClass("son").addClass("soff").prop("title",global.sound_off),$(".t_icon, .f_icon").hide(),$("body").css("background-color",e.color_backg),$("#com_b").on("click",function(e){e.preventDefault();var a=$.trim($("#comment").val());if(""!=a){$("#com_b").prop("disabled",!0);var t=global.q_channel+"-"+cascade.subscribedData.id;$.ajax({url:"/chat_trigger.php?t=comment",type:"POST",dataType:"json",data:{channel:t,com:a},success:function(){return $("#comments").html("<p>Thanks for commenting!</p>"),!1},error:function(){return $("#comments").html("<p>Sorry, it failed to submit.</p>"),!1}})}return!1});var o=parseInt(global.mdl.get("height"));if(340!=o){var s=$("#msg_con").css("height");if("160px"===s){var n=o/340*.9,i=parseInt(160*n),r=parseInt(72*n);$("#msg_con").css("height",i),$("#chat_txt").css("height",r)}}}function doLogin(){var e=$("#chat_txt"),a={};if(e.prop("disabled",!0).addClass("ci"),global.username=$.trim($("#name").val()),global.username=global.username.replace(/["']{1}/gi,""),""===global.peel){if(""!=global.initialq&&""==$.trim($("#ques").val()))return alert("Please fill out "+global.initialq),$(".load_gif").hide(),$("#lc_cb").show(),!1;if(""===global.username){if(!global.mdl.get("enable_anon"))return alert("Please enter your name"),$("#name").focus(),!1;global.username=generateAnonName(),$("#name").val(global.username)}for(var t=1;5>=t;t++){var l="user"+t,o=global.mdl.get(l);if(1==o.get("show")){var s=$.trim($("#"+l).val());o.set("val",s);var o={fldID:l,name:o.get("name"),val:s,show:1};a[l]=o}else{var o={fldID:l,name:o.get("name"),val:"",show:0};a[l]=o}}}$(".load_gif").show(),$("#lc_cb").hide();var n=global.depart_id;parseInt(global.wtype,10)<4&&0==global.depart_id&&(n=$("#lc_dept_sel").val());var i=$.trim($("#ques").val());if(a.username=global.username,a.role=global.role,a.iid=global.iid,a.key=global.key,a.ref=global.ref,a.iq=i,i=encodeURIComponent(i),parseInt(global.wtype,10)<4){var r="&username="+global.username+"&role="+global.role+"&depart_id="+n+"&iid="+global.iid+"&key="+global.key+"&ref="+global.ref+"&iq="+i;a.depart_id=n,a.uid=-1}else{var r="&username="+global.username+"&role="+global.role+"&depart_id=0&uid="+global.uid+"&iid="+global.iid+"&key="+global.key+"&ref="+global.ref+"&iq="+i;a.depart_id=0,a.uid=global.uid}startSession(a,r)}function startSession(e,a){$.ajax({url:"/chat_startsess.php",type:"POST",dataType:"json",data:a,error:function(){chat_msg.append('<div class="lci_sys">'+global.error_sess+"</div>")},success:function(a){if(a.bip)throw $("#login").html("<p>Sorry, the IP has been blocked</p>"),new Error("Banned");""!==global.peel&&(a.session.id=global.peel),setupSocket(e,a)}})}function setupSocket(e,a){var t=$("#msgs"),l=$("#chat_txt"),o=$("#istyping");$(".load_gif").hide(),$("#login").hide(),$("#chat").fadeIn("fast"),$("#title").text(global.username),global.q_channel=a.channel,global.peeling_parent=!1;for(var s=1;5>=s;s++){var n="user"+s;a.session[n]=e[n]}global.session=a.session,global.session.peel=global.peel,global.session.iid=global.iid,cascade=io.connect(cascadeServer,{"force new connection":!1,"flash policy port":843,reconnect:!1,"max reconnection attempts":5,"connect timeout":3e4,query:$.param({iid:global.iid,key:global.key,src:"patron"})}),cascade.on("connecting",function(){}),cascade.on("reconnecting",function(){setConnectState(!1),dspChatMsg('<div class="lci_sys">connection lost - reconnecting...</div>')}),cascade.on("reconnect",function(){setConnectState(!0),dspChatMsg('<div class="lci_sys">connection re-established.</div>')}),cascade.on("error",function(e){try{setConnectState(!1),global.connected=!1,dspChatMsg('<div class="lci_sys">network error:'+e+"</div>")}catch(a){alert(a.message)}}),cascade.on("connect",function(){try{global.connected=!0,global.reconnect=!1,setConnectState(!0),DEBUG_CHAT&&console.log("connected to %s, id: $s",cascadeServer,cascade.socket.sessionid),DEBUG_CHAT&&console.log("try to subscribe to "+global.q_channel),cascade.emit("subscribe",{channel:global.q_channel,info:global.session})}catch(e){alert(e.message)}}),cascade.on("disconnect",function(){try{if(setConnectState(!1),global.connected=!1,DEBUG_CHAT&&console.log("disconnected"),dspChatMsg('<div class="lci_sys">disconnected.</div>'),global.peeling_parent&&(global.reconnect=!1),global.reconnect===!1){if(global.peeling_parent)window.location.reload();else switch(global.wtype){case widgetT.prototype.SYSTEM_BUTTON:case widgetT.prototype.DIRECT_BUTTON:resetDisplay();break;case widgetT.prototype.SYSTEM_INPAGE:case widgetT.prototype.SYSTEM_SIDE:case widgetT.prototype.DIRECT_INPAGE:resetDisplay()}global.peeling_parent=!1}}catch(e){alert(e.message)}}),cascade.on("peel_subscribed",function(e){try{DEBUG_CHAT&&console.log("peel_subscribed"),cascade.subscribedData=e.who,global.username=e.who.info.username;var a=e.channel+"-"+cascade.subscribedData.id;$("h1").attr("title","online on "+a),$("#title").text(global.username),dspChatMsgStatus(global.wait),l.prop("disabled",!1).removeClass("ci").val("").focus(),$(".t_icon, .f_icon").show(),$("div#msgs").replaceWith(e.who.peel_data.msgs),t=$("#msgs"),t.animate({scrollTop:t.prop("scrollHeight")},1e3)}catch(o){alert(o.message)}}),cascade.on("subscribed",function(a){try{DEBUG_CHAT&&console.log("subscribed:"+a.members),cascade.subscribedData=a.who;var l=a.channel+"-"+cascade.subscribedData.id;$("h1").attr("title","online on "+l);var o=a.members;_.each(o,function(e){parseInt(global.wtype,10)<4?"op"==e.info.role&&global.lc_op++:e.info.op_id==global.uid&&global.lc_op++}),0==global.lc_op?(t.html('<div class="lci_sys">'+global.error_offline+"</div>"),$("#msg_con").animate({scrollTop:$("#msg_con").prop("scrollHeight")},1e3),global.reconnect=!1,cascade.disconnect()):(""!=e.iq&&(e.iq=e.iq.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),t.append('<div class="lci_sys">'+e.iq+"</div>")),dspChatMsgStatus(global.wait))}catch(s){alert(s.message)}}),cascade.on("chat_with",function(e){try{cascade.subscribedData.withWho=e.withWho,l.prop("disabled",!1).removeClass("ci").val("").focus(),$(".f_icon").show(),$(".t_icon").show(),dspChatMsgStatus(e.chat_with.from_name+global.joined),play_sound(),widgetT.prototype.showPeelOutIcon[global.wtype]&&$("#peel_out").show()}catch(a){alert(a.message)}}),cascade.on("co_browse_request",function(){try{dspChatMsg('<div class="lci_sys"><a href="#" onclick="startCoBrowse(event); return false;">Click to start co-browse session</a></div><br>')}catch(e){alert(e.message)}}),cascade.on("typing_status",function(e){try{if(e.name==global.username)return!1;e.status===!0&&"op"==e.role?o.html(e.name+global.typing):o.text("")}catch(a){alert(a.message)}}),cascade.on("new_message",function(e){try{var a=e.name;dspChatMsg('<div class="lci_msg"><span class="lci_un"><label id="="chat_msg_aria_lbl" for="chat_msg_line" class="sreader_hide">chat message</label>'+a+'</label> :</span> <span id="chat_msg_line" aria-labelledby="chat_msg_aria_lbl"> '+e.message+'<br /></span> <span class="lci_published" pubtime="'+e.published+'" title="'+e.published+'" aria-hidden="true" >'+timeToDescription(e.published)+"</span></div>"),play_sound(),l.prop("disabled",!1).removeClass("ci")}catch(t){alert(t.message)}}),cascade.on("chat_end",function(e){try{o.text(""),dspChatMsg('<div class="lci_sys">'+e.info.username+global.left+"</div>"),play_sound(),global.reconnect=!1,cascade.disconnect()}catch(a){alert(a.message)}}),cascade.on("chat_left",function(e){try{var a=e.userData;o.text(""),dspChatMsgStatus(a.info.username+global.left),play_sound()}catch(t){alert(t.message)}}),cascade.on("member_removed",function(e){try{void 0!=cascade.subscribedData.withWho&&"op"===e.info.role&&cascade.subscribedData.withWho.op_id==e.info.op_id&&(dspChatMsg('<div class="lci_sys">'+e.info.username+global.left+"</div>"),play_sound())}catch(a){alert(a.message)}}),startTime()}function startTime(){setInterval(function(){$("#msgs .lci_published").each(function(e,a){var t=$(a).attr("pubtime"),l=timeToDescription(t);$(a).text(l)})},15e3)}function timeToDescription(e){e instanceof Date==!1&&(e=Date.parse(e));var a="",t=new Date,l=t-e,o=Math.round(l/1e3),s=Math.round(o/60),n=Math.round(s/60);return 5>o?a="just now":60>o?a=o+" second"+(1!==o?"s":"")+" ago":60>s&&1>n?a="about "+s+" minute"+(1!==s?"s":"")+" ago":24>n&&(a="about "+n+" hour"+(1!==n?"s":"")+" ago"),a}function startCoBrowse(e){e.preventDefault(),savePeelData(1);var a={};a.cmd="co_browse",a.session=global.session,a.session.chaturl="//"+global.ladom+"/chati.php?"+global.query_string+"&peel="+cascade.subscribedData.id,window.parent.postMessage(JSON.stringify(a),"*")}function setConnectState(e){var a,t;e?(a="green",t="connected"):(a="red",t="disconnected");var l=$("#connect_state");l.css("color",a),l.html(t)}function generateAnonName(){var e=Math.floor(99999999*Math.random());return global.guest_input+e}function savePeelData(e){var a={};a.msgs=$("<div />").append($("#msgs").clone()).html(),a.cobrowse=e,cascade.emit("peel_save_data",a)}function peelOut(e){savePeelData(0),global.peeling_parent=!0;var a="//"+global.ladom+"/chati.php?"+global.query_string+"&peel="+cascade.subscribedData.id,t=e.open(a,"name","height=310,width=310,fullscreen=0,location=0,menubar=0,status=0");e.focus&&t.focus()}function play_sound(){try{global.enable_sound&&$("#sound").jPlayer("play")}catch(e){}return!1}function typing_status(e){var a=cascade.subscribedData;cascade.emit("typing_status",{id:a.id,room:a.id,op2op:"",status:e})}var widgetModelT=Backbone.Model.extend({defaults:{id:"0",iid:0,hash:"",name:"",ts:new Date,uid:0,ref:"",key:"",domain:"",chat_title:"Welcome to LibChat!",byeMsg:"Thanks for chatting!",dept_label:"Select Department:",name_label:"Name (leave blank for anonymous chat)",name_default:"",guest_label:"Guest",width:240,height:340,is_personal:!1,chat_button:"Start Chat",done_button:"Chat again",press_enter:"Press ENTER to send",offline_text:"Ask Us",offline_url:"",offline_title:"Chat is offline - Ask a Question or browse our existing Answers!",slidebutton_url:"//libchat.s3.amazonaws.com/chat_button_online.png",slidebutton_url_off:"//libchat.s3.amazonaws.com/chat_button_offline.png",slidebutton_position:"r",slidebutton_bcolor:"#1E862F",slidebutton_width:"34",slidebutton_height:"125",la_hide:!0,la_hide_msg:"Sorry, chat is offline but you can still get help.",la_hide_msg2:"<a href='http://{{ domain }}'>Search our Knowledgebase and/or submit your question</a>",la_top_options:"1,50,0,0,130,80",sound_on:"Sound is On",sound_off:"Sound is Off",ops_left:"Thanks for chatting with us!",star_text:"Please rate this chat:",trans:"Enter an email address to send this chat transcript to:",error_sess:"Error starting session.",error_send:"Error sending this message.",error_tran:"Error sending transcript.",left:" has left the chat",typing:" is typing...",joined:" has joined the chat",initial_question:!1,initial_question_label:"Your Question",comments_label:"Any comments?",comments_button_text:"Submit Comments",enable_anon:!0,enable_comments:!0,enable_sound:!0,star_ratings:!0,file_uploads:!0,css:"//libchat.s3.amazonaws.com/chat_client_inline_iframe.css?v1.00",custom_css:"",color_backg:"#f9f9f9",color_border:"#eeeeee",color_head:"#3278e0",color_btn:"#FFFFFF",user1:null,user2:null,user3:null,user4:null,user5:null,error_off:null,wait:null,depart_id:"0",depart_dedicated:!0,depart_default_id:"0",widget_type:"2",department_selector:""},initialize:function(){var e=parseInt(this.get("widget_type"));4>e?(null==this.get("error_off")&&this.set("error_off","Sorry it doesn't appear any librarians are online... Please try again later."),null==this.get("wait")&&this.set("wait","Please wait... A librarian will connect shortly!")):(null==this.get("error_off")&&this.set("error_off","Sorry it doesn't appear {{ operator }} is online... Please try again later."),null==this.get("wait")&&this.set("wait","Please wait... {{ operator }} will connect shortly!"));for(var a=1;5>=a;a++){var t="user"+a,l=this.get(t);null==l?this.set(t,new customFieldModelT({tag:a})):"customFieldModelT"!=typeof l&&this.set(t,new customFieldModelT(l))}"undefined"==typeof global.department_selector&&(global.department_selector=global.depart_html),"undefined"==typeof global.department_selector&&(global.department_selector=""),this.set("department_selector",'<div class="login_field"><span id="chat_depts">'+global.department_selector+"</span></div>"),global.department_selector2="undefined"==typeof global.department_selector?"":global.department_selector.replace("lc_dept_sel","lc_dept_sel2"),this.set("department_selector2",'<div class="login_field"><span id="chat_depts2">'+global.department_selector2+"</span></div>"),this.set("la_hide_msg",_.template(this.get("la_hide_msg"),{domain:this.get("domain")})),this.set("la_hide_msg2",_.template(this.get("la_hide_msg2"),{domain:this.get("domain")}))}}),widgetCollectionT=Backbone.Collection.extend({model:widgetModelT}),customFieldModelT=Backbone.Model.extend({defaults:{name:"click to edit",id:0,show:0,required:0,type:"t",val:""},initialize:function(){},reset:function(){this.set({id:0,show:0,name:"click to edit",type:"t"})}});!function(e,a,t){function l(e){var a={},l=/^jQuery\d+$/;return t.each(e.attributes,function(e,t){t.specified&&!l.test(t.name)&&(a[t.name]=t.value)}),a}function o(e,l){var o=this,s=t(o);if(o.value==s.attr("placeholder")&&s.hasClass("placeholder"))if(s.data("placeholder-password")){if(s=s.hide().next().show().attr("id",s.removeAttr("id").data("placeholder-id")),e===!0)return s[0].value=l;s.focus()}else o.value="",s.removeClass("placeholder"),o==a.activeElement&&o.select()}function s(){var e,a=this,s=t(a),n=this.id;if(""==a.value){if("password"==a.type){if(!s.data("placeholder-textinput")){try{e=s.clone().attr({type:"text"})}catch(i){e=t("<input>").attr(t.extend(l(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":s,"placeholder-id":n}).bind("focus.placeholder",o),s.data({"placeholder-textinput":e,"placeholder-id":n}).before(e)}s=s.removeAttr("id").hide().prev().attr("id",n).show()}s.addClass("placeholder"),s[0].value=s.attr("placeholder")}else s.removeClass("placeholder")}var n,i,r="placeholder"in a.createElement("input"),c="placeholder"in a.createElement("textarea"),d=t.fn,p=t.valHooks,u=t.propHooks;r&&c?(i=d.placeholder=function(){return this},i.input=i.textarea=!0):(i=d.placeholder=function(){var e=this;return e.filter((r?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":o,"blur.placeholder":s}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},i.input=r,i.textarea=c,n={get:function(e){var a=t(e),l=a.data("placeholder-password");return l?l[0].value:a.data("placeholder-enabled")&&a.hasClass("placeholder")?"":e.value},set:function(e,l){var n=t(e),i=n.data("placeholder-password");return i?i[0].value=l:n.data("placeholder-enabled")?(""==l?(e.value=l,e!=a.activeElement&&s.call(e)):n.hasClass("placeholder")?o.call(e,!0,l)||(e.value=l):e.value=l,n):e.value=l}},r||(p.input=n,u.value=n),c||(p.textarea=n,u.value=n),t(function(){t(a).delegate("form","submit.placeholder",function(){var e=t(".placeholder",this).each(o);setTimeout(function(){e.each(s)},10)})}),t(e).bind("beforeunload.placeholder",function(){t(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery);var DEBUG_CHAT=!1,COBROWSE=!1,cascade=global.cascade;global.connected=!1,global.reconnect=!1,widgetT.prototype.SYSTEM_BUTTON=1,widgetT.prototype.SYSTEM_INPAGE=2,widgetT.prototype.SYSTEM_SIDE=3,widgetT.prototype.DIRECT_INPAGE=4,widgetT.prototype.DIRECT_BUTTON=5,widgetT.prototype.showPeelOutIcon=[!1,!1,!0,!0,!0,!1],widgetT.prototype.resetAction=[!1,window.close,resetDisplay,resetDisplay,resetDisplay,window.close],$(function(){var e=new Array;null!=global.custom.template&&e.push(global.custom.template),e.push("templates/widgets.html"),null!=global.custom.template_css&&e.push(global.custom.template_css),loadTemplates(e,{success:function(e){$("head").append(e.data)},failure:function(){alert("There was an error loading the templates.")},always:function(){var e=$("#template-login-panel").html();if("undefined"==typeof e)alert("error loading templates");else try{_init()}catch(a){alert("Fatal error in init:"+a.message)}}})});var timout_function=function(){global.is_typing_currently=!1,typing_status("0")};
//# sourceMappingURL=chat_client_la_iframe_min.js.map